# 이벤트 버블링에 대해 설명하세요

## 1. 개념

### 버블링

한 요소에 이벤트가 발생하면, 이 요소에 할당된 핸들러가 동작하고, 이어서 부모 요소의 핸들러가 동작합니다. 가장 최상단의 조상 요소를 만날 때까지 이 과정이 반복되면서 요소 각각에 할당된 핸들러가 동작합니다.

```js
<form onclick="alert('form')">
  FORM
  <div onclick="alert('div')">
    DIV
    <p onclick="alert('p')">P</p>
  </div>
</form>
```

여기서 `<p>`를 클릭하면

- `<p>`에 할당된 onclick 핸들러가 동작합니다
- 바깥의 `<div>`에 할당된 핸들러가 동작합니다.
- 그 바깥의 `<form>`에 할당된 핸들러가 동작합니다
- document 객체를 만날 때까지(최상위 객체) 각 요소에 할당된 onclick 핸들러가 동작합니다.

### 캡처링

표준 DOM 이벤트에서 정의한 이벤트 흐름엔 3가지 단계가 있습니다.

1. 캡처링 단계 - 이벤트가 하위 요소로 전파되는 단계
2. 타깃 단계 - 이벤트가 실제 타깃 요소에 전달되는 단계
3. 버블링 단계 - 이벤트가 상위요소로 전파되는 단계

예를 들어 어떤 태그를 클릭하면 최상위 조상에서 시작해 아래로 전파되고(캡처링 단계), 이벤트가 타깃 요소에 도착해 실행된 후(타깃 단계), 다시 위로 전파됩니다.(버블링 단계) 이런 과정을 통해 요소에 할당된 이벤트 핸들러가 호출됩니다. 그러나 캡처링은 `on<event>`프로퍼티나 HTML 속성, addEventListener(event,handler)를 이용해 할당된 핸들러는 감지할 수 없습니다. 즉, 이 핸들러들은 타깃 단계와 버블링 단계에서만 동작합니다. 캡처링 단계에서 이벤트를 잡아내려면 addEventListener의 capture 옵션을 true로 설정해야 합니다.

```js
<form>FORM
  <div>DIV
    <p>P</p>
  </div>
</form>

<script>
  for(let elem of document.querySelectorAll('*')) {
    elem.addEventListener("click", e => alert(`캡쳐링: ${elem.tagName}`), true);
    elem.addEventListener("click", e => alert(`버블링: ${elem.tagName}`));
  }
</script>
```

여기서 `<p>`를 클릭하면 다음과 같은 순서로 이벤트가 전달됩니다.

1. HTML -> BODY -> FORM -> DIV (캡처링 단계)
2. p(타깃 단계, 캡쳐링과 버블링 둘 다에 리스너를 설정했기 떄문에 두 번 호출됩니다.)
3. DIV -> FORM -> BODY -> HTML(버블링 단계)

### 이벤트 위임

하위 요소에 각각 이벤트를 붙이지 않고 상위 요소에서 하위 요소의 이벤트를 제어하는 방식을 말합니다.

상위 요소에 이벤트 리스너를 달아놓고 하위 요소들을 클릭하였을때 이벤트 버블링이 발생하여 이벤트 리스너가 의도한 대로 동작하게됩니다. 이렇게 코드를 짜면 하위요소를 추가해도 또 다시 이벤트 리스너를 써줄필요없이 간편하게 클릭 이벤트를 동작시킬 수 있습니다.

## 3. 답변

이벤트 버블링이란 어떤 요소에서 이벤트가 발생하면 부모요소로 전파되고 최상위 요소 까지 전파되는 현상을 말합니다. 예를 들어 하위요소에서 클릭 이벤트가 발생하면 그 상위, 그 상위의 상위 요소에서도 클릭 이벤트가 발생합니다. 자바스크립트에서는 이벤트가 이런식으로 전파가 됩니다. 이벤트 캡처링은 최상위 요소에서 타깃 요소까지 이벤트가 내려오는 것을 말합니다. 그러나 이벤트 캡처링은 평상시에는 감지할 수 없고 addEventListener의 두번째 인자에 capture: true 옵션을 추가로 써줘야(또는 true만 써도됨) 작동을 합니다. 이벤트 위임은 하위 요소에 각각 이벤트를 부여하지않고 상위 요소에서 하위 요소의 이벤트를 제어하는 방식을 말합니다. 이벤트 위임은 하위 요소에서 발생하는 이벤트 버블링을 이용합니다.

# 출처

- https://ko.javascript.info/bubbling-and-capturing
- https://joshua1988.github.io/web-development/javascript/event-propagation-delegation/
